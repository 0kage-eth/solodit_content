**Auditors**

[Zokyo](https://x.com/zokyo_io)

# Findings

## High Risk

###  Out of range index in `getTokenBurnFee()` causes function reversion after 14 days

**Severity**: Critical

**Status**: Resolved

**Location**: PoolBase.sol

**Description**
The `getTokenBurnFee()` function in `PoolBase.sol` attempts to return `burnFees[feeCycle.length]` after 14 days of asset locking, which is out of range for the burnFees array. This out-of-bounds access results in the function reverting, causing subsequent `unstake` operations to fail and denying users access to their assets after the maturity period has passed.

```solidity
920 function getTokenBurnFee(address _staker) public view returns (uint256) {
921     User memory user = users[_staker];
922     for (uint256 i; i < feeCycle.length; i++) {
923     if (
924         (block.timestamp < user.lastUnstakedTimestamp + feeCycle[i]) ||
925         block.timestamp < user.lastInvestTimestamp + feeCycle[i]
926     ) {
927         return burnFees[i];
928     }
929     }
930     return burnFees[feeCycle.length];
931 }
```

**Recommendation**: 
To resolve this issue, the function should be modified to handle cases where the index feeCycle.length is out of range more gracefully. Instead of accessing burnFees[feeCycle.length] directly, consider returning a default burn fee value, or change the index to feeCycle.length-1.  

**Fix**:  
Issue fixed at commit a9767ff4

